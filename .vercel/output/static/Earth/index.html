<!DOCTYPE html><html lang="en" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.9.4"><title>Astro Basics</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Audiowide&display=swap" rel="stylesheet"><link rel="stylesheet" href="/_astro/Earth.sRqi98Dx.css">
<style>body{margin:0;padding:0;overflow:hidden;background:#000;font-family:Arial,sans-serif}#info[data-astro-cid-fpuvirey]{position:absolute;top:10px;left:10px;color:#fff;z-index:100;font-size:14px;line-height:1.4}#info[data-astro-cid-fpuvirey] a[data-astro-cid-fpuvirey]{color:#4db2ff;text-decoration:none}#info[data-astro-cid-fpuvirey] a[data-astro-cid-fpuvirey]:hover{text-decoration:underline}
</style></head> <body class="bg-black " data-astro-cid-sckkx6r4> <div class="shooting-star" data-astro-cid-sckkx6r4></div> <div class="shooting-star" data-astro-cid-sckkx6r4></div> <div class="shooting-star" data-astro-cid-sckkx6r4></div> <div class="shooting-star" data-astro-cid-sckkx6r4></div> <div class="shooting-star" data-astro-cid-sckkx6r4></div> <div class="shooting-star" data-astro-cid-sckkx6r4></div> <div class="shooting-star" data-astro-cid-sckkx6r4></div> <div class="shooting-star" data-astro-cid-sckkx6r4></div> <div class="shooting-star" data-astro-cid-sckkx6r4></div> <div class="shooting-star" data-astro-cid-sckkx6r4></div> <div class="shooting-star" data-astro-cid-sckkx6r4></div> <div class="shooting-star" data-astro-cid-sckkx6r4></div>  <link rel="preload" as="image" href="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/NASA_logo.svg/2449px-NASA_logo.svg.png"/><header class=" text-white p-4 fixed min-w-full z-100"><div class="flex items-center justify-between p-2 m-2 rounded-4xl bg-gray-800/50 backdrop-blur-md shadow-lg"><a href="/" class="w-1/2 flex items-center justify-start"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/NASA_logo.svg/2449px-NASA_logo.svg.png" class="max-w-14"/><h1 class="LandingPageFont text-2xl">NASA Missions</h1></a><div class="w-1/2"><nav class="flex items-center justify-end gap-6 pr-4"><a href="/MarsExperience" class="relative text-white/90 hover:text-white transition-colors duration-300 after:content-[&#x27;&#x27;] after:absolute after:-bottom-1 after:left-0 after:h-[2px] after:w-0 after:bg-white after:transition-all after:duration-300 hover:after:w-full">Mars Experience</a><a href="/PhotoOfTheDay" class="relative text-white/90 hover:text-white transition-colors duration-300 after:content-[&#x27;&#x27;] after:absolute after:-bottom-1 after:left-0 after:h-[2px] after:w-0 after:bg-white after:transition-all after:duration-300 hover:after:w-full">Photo of the Day</a><a href="/Earth" class="relative text-white/90 hover:text-white transition-colors duration-300 after:content-[&#x27;&#x27;] after:absolute after:-bottom-1 after:left-0 after:h-[2px] after:w-0 after:bg-white after:transition-all after:duration-300 hover:after:w-full">3D Earth</a><a href="/NasaImagesExperience" class="relative text-white/90 hover:text-white transition-colors duration-300 after:content-[&#x27;&#x27;] after:absolute after:-bottom-1 after:left-0 after:h-[2px] after:w-0 after:bg-white after:transition-all after:duration-300 hover:after:w-full">NASA Images Experience</a></nav></div></div></header>  </body></html> <title>three.js webgpu - earth</title> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">  <script type="importmap">
	{
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.169.0/build/three.webgpu.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/"
        }
    }
</script> <script type="module">
	import * as THREE from 'three';
	import { step, normalWorld, output, texture, vec3, vec4, normalize, positionWorld, bumpMap, cameraPosition, color, uniform, mix, uv, max } from 'three';
	import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
	import { GUI } from 'three/addons/libs/lil-gui.module.min.js';

	let camera, scene, renderer, controls, globe, clock;

	init();

	function init() {
		clock = new THREE.Clock();

		camera = new THREE.PerspectiveCamera(25, window.innerWidth / window.innerHeight, 0.1, 100);
		camera.position.set(4.5, 2, 3);

		scene = new THREE.Scene();

		// sun
		const sun = new THREE.DirectionalLight('#ffffff', 2);
		sun.position.set(0, 0, 3);
		scene.add(sun);

		// uniforms
		const atmosphereDayColor = uniform(color('#4db2ff'));
		const atmosphereTwilightColor = uniform(color('#bc490b'));
		const roughnessLow = uniform(0.25);
		const roughnessHigh = uniform(0.35);

		// You'll need to add your texture files to public/textures/planets/
		const textureLoader = new THREE.TextureLoader();

		const dayTexture = textureLoader.load('/textures/planets/earth_day_4096.jpg');
		dayTexture.colorSpace = THREE.SRGBColorSpace;
		dayTexture.anisotropy = 8;

		const nightTexture = textureLoader.load('/textures/planets/earth_night_4096.jpg');
		nightTexture.colorSpace = THREE.SRGBColorSpace;
		nightTexture.anisotropy = 8;

		const bumpRoughnessCloudsTexture = textureLoader.load('/textures/planets/earth_bump_roughness_clouds_4096.jpg');
		bumpRoughnessCloudsTexture.anisotropy = 8;

		// fresnel
		const viewDirection = positionWorld.sub(cameraPosition).normalize();
		const fresnel = viewDirection.dot(normalWorld).abs().oneMinus().toVar();

		// sun orientation
		const sunOrientation = normalWorld.dot(normalize(sun.position)).toVar();

		// atmosphere color
		const atmosphereColor = mix(atmosphereTwilightColor, atmosphereDayColor, sunOrientation.smoothstep(-0.25, 0.75));

		// globe
		const globeMaterial = new THREE.MeshStandardNodeMaterial();

		const cloudsStrength = texture(bumpRoughnessCloudsTexture, uv()).b.smoothstep(0.2, 1);
		globeMaterial.colorNode = mix(texture(dayTexture), vec3(1), cloudsStrength.mul(2));

		const roughness = max(
			texture(bumpRoughnessCloudsTexture).g,
			step(0.01, cloudsStrength)
		);
		globeMaterial.roughnessNode = roughness.remap(0, 1, roughnessLow, roughnessHigh);

		const night = texture(nightTexture);
		const dayStrength = sunOrientation.smoothstep(-0.25, 0.5);

		const atmosphereDayStrength = sunOrientation.smoothstep(-0.5, 1);
		const atmosphereMix = atmosphereDayStrength.mul(fresnel.pow(2)).clamp(0, 1);

		let finalOutput = mix(night.rgb, output.rgb, dayStrength);
		finalOutput = mix(finalOutput, atmosphereColor, atmosphereMix);

		globeMaterial.outputNode = vec4(finalOutput, output.a);

		const bumpElevation = max(
			texture(bumpRoughnessCloudsTexture).r,
			cloudsStrength
		);
		globeMaterial.normalNode = bumpMap(bumpElevation);

		const sphereGeometry = new THREE.SphereGeometry(1, 64, 64);
		globe = new THREE.Mesh(sphereGeometry, globeMaterial);
		scene.add(globe);

		// atmosphere
		const atmosphereMaterial = new THREE.MeshBasicNodeMaterial({ side: THREE.BackSide, transparent: true });
		let alpha = fresnel.remap(0.73, 1, 1, 0).pow(3);
		alpha = alpha.mul(sunOrientation.smoothstep(-0.5, 1));
		atmosphereMaterial.outputNode = vec4(atmosphereColor, alpha);

		const atmosphere = new THREE.Mesh(sphereGeometry, atmosphereMaterial);
		atmosphere.scale.setScalar(1.04);
		scene.add(atmosphere);

		// debug


		// renderer
		renderer = new THREE.WebGPURenderer();
		renderer.setPixelRatio(window.devicePixelRatio);
		renderer.setSize(window.innerWidth, window.innerHeight);
		renderer.setAnimationLoop(animate);
		document.body.appendChild(renderer.domElement);

		// controls
		controls = new OrbitControls(camera, renderer.domElement);
		controls.enableDamping = true;
		controls.minDistance = 0.1;
		controls.maxDistance = 50;

		window.addEventListener('resize', onWindowResize);
	}

	function onWindowResize() {
		camera.aspect = window.innerWidth / window.innerHeight;
		camera.updateProjectionMatrix();
		renderer.setSize(window.innerWidth, window.innerHeight);
	}

	async function animate() {
		const delta = clock.getDelta();
		globe.rotation.y += delta * 0.025;

		controls.update();

		renderer.render(scene, camera);
	}
</script> 